window.wp=window.wp||{},function(e,t){var n,r,i,s,o=Array.prototype.slice;r=function(e,t){var n=s(this,e,t);return n.extend=this.extend,n},i=function(){},s=function(e,n,r){var s;return s=n&&n.hasOwnProperty("constructor")?n.constructor:function(){var t=e.apply(this,arguments);return t},t.extend(s,e),i.prototype=e.prototype,s.prototype=new i,n&&t.extend(s.prototype,n),r&&t.extend(s,r),s.prototype.constructor=s,s.__super__=e.prototype,s},n={},n.Class=function(e,r,i){var s,o=arguments;return e&&r&&n.Class.applicator===e&&(o=r,t.extend(this,i||{})),s=this,this.instance&&(s=function(){return s.instance.apply(s,arguments)},t.extend(s,this)),s.initialize.apply(s,o),s},n.Class.applicator={},n.Class.prototype.initialize=function(){},n.Class.prototype.extended=function(e){for(var t=this;"undefined"!=typeof t.constructor;){if(t.constructor===e)return!0;if("undefined"==typeof t.constructor.__super__)return!1;t=t.constructor.__super__}return!1},n.Class.extend=r,n.Events={trigger:function(e){return this.topics&&this.topics[e]&&this.topics[e].fireWith(this,o.call(arguments,1)),this},bind:function(e){return this.topics=this.topics||{},this.topics[e]=this.topics[e]||t.Callbacks(),this.topics[e].add.apply(this.topics[e],o.call(arguments,1)),this},unbind:function(e){return this.topics&&this.topics[e]&&this.topics[e].remove.apply(this.topics[e],o.call(arguments,1)),this}},n.Value=n.Class.extend({initialize:function(e,n){this._value=e,this.callbacks=t.Callbacks(),t.extend(this,n||{}),this.set=t.proxy(this.set,this)},instance:function(){return arguments.length?this.set.apply(this,arguments):this.get()},get:function(){return this._value},set:function(e){var t=this._value;return e=this._setter.apply(this,arguments),e=this.validate(e),null===e||this._value===e?this:(this._value=e,this.callbacks.fireWith(this,[e,t]),this)},_setter:function(e){return e},setter:function(e){var t=this.get();return this._setter=e,this._value=null,this.set(t),this},resetSetter:function(){return this._setter=this.constructor.prototype._setter,this.set(this.get()),this},validate:function(e){return e},bind:function(){return this.callbacks.add.apply(this.callbacks,arguments),this},unbind:function(){return this.callbacks.remove.apply(this.callbacks,arguments),this},link:function(){var e=this.set;return t.each(arguments,function(){this.bind(e)}),this},unlink:function(){var e=this.set;return t.each(arguments,function(){this.unbind(e)}),this},sync:function(){var e=this;return t.each(arguments,function(){e.link(this),this.link(e)}),this},unsync:function(){var e=this;return t.each(arguments,function(){e.unlink(this),this.unlink(e)}),this}}),n.Values=n.Class.extend({defaultConstructor:n.Value,initialize:function(e){t.extend(this,e||{}),this._value={},this._deferreds={}},instance:function(e){return 1===arguments.length?this.value(e):this.when.apply(this,arguments)},value:function(e){return this._value[e]},has:function(e){return"undefined"!=typeof this._value[e]},add:function(e,t){return this.has(e)?this.value(e):(this._value[e]=t,t.parent=this,t.extended(n.Value)&&t.bind(this._change),this.trigger("add",t),this._deferreds[e]&&this._deferreds[e].resolve(),this._value[e])},create:function(e){return this.add(e,new this.defaultConstructor(n.Class.applicator,o.call(arguments,1)))},each:function(e,n){n="undefined"==typeof n?this:n,t.each(this._value,function(t,r){e.call(n,r,t)})},remove:function(e){var t;this.has(e)&&(t=this.value(e),this.trigger("remove",t),t.extended(n.Value)&&t.unbind(this._change),delete t.parent),delete this._value[e],delete this._deferreds[e]},when:function(){var e=this,n=o.call(arguments),r=t.Deferred();return t.isFunction(n[n.length-1])&&r.done(n.pop()),t.when.apply(t,t.map(n,function(n){return e.has(n)?void 0:e._deferreds[n]=e._deferreds[n]||t.Deferred()})).done(function(){var i=t.map(n,function(t){return e(t)});return i.length!==n.length?(e.when.apply(e,n).done(function(){r.resolveWith(e,i)}),void 0):(r.resolveWith(e,i),void 0)}),r.promise()},_change:function(){this.parent.trigger("change",this)}}),t.extend(n.Values.prototype,n.Events),n.ensure=function(e){return"string"==typeof e?t(e):e},n.Element=n.Value.extend({initialize:function(e,r){var i,s,o,u=this,a=n.Element.synchronizer.html;this.element=n.ensure(e),this.events="",this.element.is("input, select, textarea")&&(this.events+="change",a=n.Element.synchronizer.val,this.element.is("input")?(i=this.element.prop("type"),n.Element.synchronizer[i]&&(a=n.Element.synchronizer[i]),("text"===i||"password"===i)&&(this.events+=" keyup")):this.element.is("textarea")&&(this.events+=" keyup")),n.Value.prototype.initialize.call(this,null,t.extend(r||{},a)),this._value=this.get(),s=this.update,o=this.refresh,this.update=function(e){e!==o.call(u)&&s.apply(this,arguments)},this.refresh=function(){u.set(o.call(u))},this.bind(this.update),this.element.bind(this.events,this.refresh)},find:function(e){return t(e,this.element)},refresh:function(){},update:function(){}}),n.Element.synchronizer={},t.each(["html","val"],function(e,t){n.Element.synchronizer[t]={update:function(e){this.element[t](e)},refresh:function(){return this.element[t]()}}}),n.Element.synchronizer.checkbox={update:function(e){this.element.prop("checked",e)},refresh:function(){return this.element.prop("checked")}},n.Element.synchronizer.radio={update:function(e){this.element.filter(function(){return this.value===e}).prop("checked",!0)},refresh:function(){return this.element.filter(":checked").val()}},t.support.postMessage=!!window.postMessage,n.Messenger=n.Class.extend({add:function(e,t,r){return this[e]=new n.Value(t,r)},initialize:function(e,n){var r=window.parent==window?null:window.parent;t.extend(this,n||{}),this.add("channel",e.channel),this.add("url",e.url||""),this.add("targetWindow",e.targetWindow||r),this.add("origin",this.url()).link(this.url).setter(function(e){return e.replace(/([^:]+:\/\/[^\/]+).*/,"$1")}),this.receive=t.proxy(this.receive,this),this.receive.guid=t.guid++,t(window).on("message",this.receive)},destroy:function(){t(window).off("message",this.receive)},receive:function(e){var t;e=e.originalEvent,this.targetWindow()&&(this.origin()&&e.origin!==this.origin()||"string"==typeof e.data&&"{"===e.data[0]&&(t=JSON.parse(e.data),t&&t.id&&"undefined"!=typeof t.data&&(!t.channel&&!this.channel()||this.channel()===t.channel)&&this.trigger(t.id,t.data)))},send:function(e,t){var n;t="undefined"==typeof t?null:t,this.url()&&this.targetWindow()&&(n={id:e,data:t},this.channel()&&(n.channel=this.channel()),this.targetWindow().postMessage(JSON.stringify(n),this.origin()))}}),t.extend(n.Messenger.prototype,n.Events),n=t.extend(new n.Values,n),n.get=function(){var e={};return this.each(function(t,n){e[n]=t.get()}),e},e.customize=n}(wp,jQuery);