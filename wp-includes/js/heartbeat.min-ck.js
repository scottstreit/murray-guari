!function(e,t,n){var r=function(){function r(){if("string"==typeof t.pagenow&&(O.screenId=t.pagenow),"string"==typeof t.ajaxurl&&(O.url=t.ajaxurl),"object"==typeof t.heartbeatSettings){var n=t.heartbeatSettings;!O.url&&n.ajaxurl&&(O.url=n.ajaxurl),n.interval&&(O.mainInterval=n.interval,O.mainInterval<15?O.mainInterval=15:O.mainInterval>60&&(O.mainInterval=60)),O.screenId||(O.screenId=n.screenId||"front"),"disable"===n.suspension&&(O.suspendEnabled=!1)}O.mainInterval=1e3*O.mainInterval,O.originalInterval=O.mainInterval,e(t).on("blur.wp-heartbeat-focus",function(){d(),O.winBlurTimer=t.setTimeout(function(){h()},500)}).on("focus.wp-heartbeat-focus",function(){v(),p()}).on("unload.wp-heartbeat",function(){O.suspend=!0,O.xhr&&4!==O.xhr.readyState&&O.xhr.abort()}),t.setInterval(function(){y()},3e4),A.ready(function(){O.lastTick=i(),l()})}function i(){return(new Date).getTime()}function s(e){var n,r=e.src;if(r&&/^https?:\/\//.test(r)&&(n=t.location.origin?t.location.origin:t.location.protocol+"//"+t.location.host,0!==r.indexOf(n)))return!1;try{if(e.contentWindow.document)return!0}catch(i){}return!1}function o(e,t){var n;if(e){switch(e){case"abort":break;case"timeout":n=!0;break;case"error":if(503===t&&O.hasConnected){n=!0;break};case"parsererror":case"empty":case"unknown":O.errorcount++,O.errorcount>2&&O.hasConnected&&(n=!0)}n&&!E()&&(O.connectionError=!0,A.trigger("heartbeat-connection-lost",[e,t]))}}function u(){O.hasConnected=!0,E()&&(O.errorcount=0,O.connectionError=!1,A.trigger("heartbeat-connection-restored"))}function f(){var n,r;O.connecting||O.suspend||(O.lastTick=i(),r=e.extend({},O.queue),O.queue={},A.trigger("heartbeat-send",[r]),n={data:r,interval:O.tempInterval?O.tempInterval/1e3:O.mainInterval/1e3,_nonce:"object"==typeof t.heartbeatSettings?t.heartbeatSettings.nonce:"",action:"heartbeat",screen_id:O.screenId,has_focus:O.hasFocus},O.connecting=!0,O.xhr=e.ajax({url:O.url,type:"post",timeout:3e4,data:n,dataType:"json"}).always(function(){O.connecting=!1,l()}).done(function(e,t,n){var r;return e?(u(),e.nonces_expired?(A.trigger("heartbeat-nonces-expired"),void 0):(e.heartbeat_interval&&(r=e.heartbeat_interval,delete e.heartbeat_interval),A.trigger("heartbeat-tick",[e,t,n]),r&&T(r),void 0)):(o("empty"),void 0)}).fail(function(e,t,n){o(t||"unknown",e.status),A.trigger("heartbeat-error",[e,t,n])}))}function l(){var e=i()-O.lastTick,n=O.mainInterval;O.suspend||(O.hasFocus?O.countdown>0&&O.tempInterval&&(n=O.tempInterval,O.countdown--,O.countdown<1&&(O.tempInterval=0)):n=12e4,t.clearTimeout(O.beatTimer),n>e?O.beatTimer=t.setTimeout(function(){f()},n-e):f())}function h(){m(),O.hasFocus=!1}function p(){m(),O.userActivity=i(),O.suspend=!1,O.hasFocus||(O.hasFocus=!0,l())}function d(){e("iframe").each(function(n,r){s(r)&&(e.data(r,"wp-heartbeat-focus")||(e.data(r,"wp-heartbeat-focus",1),e(r.contentWindow).on("focus.wp-heartbeat-focus",function(){p()}).on("blur.wp-heartbeat-focus",function(){d(),O.frameBlurTimer=t.setTimeout(function(){h()},500)})))})}function v(){e("iframe").each(function(t,n){s(n)&&(e.removeData(n,"wp-heartbeat-focus"),e(n.contentWindow).off(".wp-heartbeat-focus"))})}function m(){t.clearTimeout(O.winBlurTimer),t.clearTimeout(O.frameBlurTimer)}function g(){O.userActivityEvents=!1,A.off(".wp-heartbeat-active"),e("iframe").each(function(t,n){s(n)&&e(n.contentWindow).off(".wp-heartbeat-active")}),p()}function y(){var t=O.userActivity?i()-O.userActivity:0;t>3e5&&O.hasFocus&&h(),O.suspendEnabled&&t>12e5&&(O.suspend=!0),O.userActivityEvents||(A.on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active",function(){g()}),e("iframe").each(function(t,n){s(n)&&e(n.contentWindow).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active",function(){g()})}),O.userActivityEvents=!0)}function w(){return O.hasFocus}function E(){return O.connectionError}function S(){O.lastTick=0,l()}function x(){O.suspendEnabled=!1}function T(e,t){var n,r=O.tempInterval?O.tempInterval:O.mainInterval;if(e){switch(e){case"fast":case 5:n=5e3;break;case 15:n=15e3;break;case 30:n=3e4;break;case 60:n=6e4;break;case"long-polling":return O.mainInterval=0,0;default:n=O.originalInterval}5e3===n?(t=parseInt(t,10)||30,t=1>t||t>30?30:t,O.countdown=t,O.tempInterval=n):(O.countdown=0,O.tempInterval=0,O.mainInterval=n),n!==r&&l()}return O.tempInterval?O.tempInterval/1e3:O.mainInterval/1e3}function N(e,t,n){return e?n&&this.isQueued(e)?!1:(O.queue[e]=t,!0):!1}function C(e){return e?O.queue.hasOwnProperty(e):void 0}function k(e){e&&delete O.queue[e]}function L(e){return e?this.isQueued(e)?O.queue[e]:n:void 0}var A=e(document),O={suspend:!1,suspendEnabled:!0,screenId:"",url:"",lastTick:0,queue:{},mainInterval:60,tempInterval:0,originalInterval:0,countdown:0,connecting:!1,connectionError:!1,errorcount:0,hasConnected:!1,hasFocus:!0,userActivity:0,userActivityEvents:!1,beatTimer:0,winBlurTimer:0,frameBlurTimer:0};return r(),{hasFocus:w,connectNow:S,disableSuspend:x,interval:T,hasConnectionError:E,enqueue:N,dequeue:k,isQueued:C,getQueuedItem:L}};t.wp=t.wp||{},t.wp.heartbeat=new r}(jQuery,window);