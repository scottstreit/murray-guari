(function(){var e=tinymce.DOM,t=function(e,t,n){var r=function(n){var r=e.controlManager.get(n),i=t.controlManager.get(n);r&&i&&i.displayColor(r.value)};r("forecolor");r("backcolor");t.setContent(e.getContent({format:"raw"}),{format:"raw"});t.selection.moveToBookmark(n);e.plugins.spellchecker&&t.plugins.spellchecker&&t.plugins.spellchecker.setLanguage(e.plugins.spellchecker.selectedLang)};tinymce.create("tinymce.plugins.FullScreenPlugin",{init:function(r,i){var s=this,o={},u=e.doc.documentElement,f,l,c,h,p,d,v;r.addCommand("mceFullScreen",function(){var t,a;if(r.getParam("fullscreen_is_enabled")){r.getParam("fullscreen_new_window")?closeFullscreen():e.win.setTimeout(function(){var e=r,t=tinyMCE.get(e.getParam("fullscreen_editor_id"));t.plugins.fullscreen.saveState(e);tinyMCE.remove(e)},10);return}if(r.getParam("fullscreen_new_window")){s.fullscreenSettings={bookmark:r.selection.getBookmark()};t=e.win.open(i+"/fullscreen.htm","mceFullScreenPopup","fullscreen=yes,menubar=no,toolbar=no,scrollbars=no,resizable=yes,left=0,top=0,width="+screen.availWidth+",height="+screen.availHeight);try{t.resizeTo(screen.availWidth,screen.availHeight)}catch(v){}}else{l=e.getStyle(e.doc.body,"overflow",1)||"auto";c=e.getStyle(u,"overflow",1);f=e.getViewPort();h=f.x;p=f.y;tinymce.isOpera&&l=="visible"&&(l="auto");tinymce.isIE&&l=="scroll"&&(l="auto");tinymce.isIE&&(c=="visible"||c=="scroll")&&(c="auto");l=="0px"&&(l="");e.setStyle(e.doc.body,"overflow","hidden");u.style.overflow="hidden";f=e.getViewPort();e.win.scrollTo(0,0);tinymce.isIE&&(f.h-=1);tinymce.isIE6||document.compatMode=="BackCompat"?d="absolute;top:"+f.y:d="fixed;top:0";n=e.add(e.doc.body,"div",{id:"mce_fullscreen_container",style:"position:"+d+";left:0;width:"+f.w+"px;height:"+f.h+"px;z-index:200000;"});e.add(n,"div",{id:"mce_fullscreen"});tinymce.each(r.settings,function(e,t){o[t]=e});o.id="mce_fullscreen";o.width=n.clientWidth;o.height=n.clientHeight-15;o.fullscreen_is_enabled=!0;o.fullscreen_editor_id=r.id;o.theme_advanced_resizing=!1;o.save_onsavecallback=function(){r.setContent(tinyMCE.get(o.id).getContent());r.execCommand("mceSave")};tinymce.each(r.getParam("fullscreen_settings"),function(e,t){o[t]=e});s.fullscreenSettings={bookmark:r.selection.getBookmark(),fullscreen_overflow:l,fullscreen_html_overflow:c,fullscreen_scrollx:h,fullscreen_scrolly:p};o.theme_advanced_toolbar_location==="external"&&(o.theme_advanced_toolbar_location="top");tinyMCE.oldSettings=tinyMCE.settings;s.fullscreenEditor=new tinymce.Editor("mce_fullscreen",o);s.fullscreenEditor.onInit.add(function(){s.loadState(s.fullscreenEditor)});s.fullscreenEditor.render();s.fullscreenElement=new tinymce.dom.Element("mce_fullscreen_container");s.fullscreenElement.update();s.resizeFunc=tinymce.dom.Event.add(e.win,"resize",function(){var e=tinymce.DOM.getViewPort(),t=s.fullscreenEditor,n,r;n=t.dom.getSize(t.getContainer().getElementsByTagName("table")[0]);r=t.dom.getSize(t.getContainer().getElementsByTagName("iframe")[0]);t.theme.resizeTo(e.w-n.w+r.w,e.h-n.h+r.h)})}});r.addButton("fullscreen",{title:"fullscreen.desc",cmd:"mceFullScreen"});r.onNodeChange.add(function(e,t){t.setActive("fullscreen",e.getParam("fullscreen_is_enabled"))});s.loadState=function(e){if(!e||!s.fullscreenSettings)throw"No fullscreen editor to load to";t(r,e,s.fullscreenSettings.bookmark);e.focus()};s.saveState=function(n){if(!n||!s.fullscreenSettings)throw"No fullscreen editor to restore from";var i=s.fullscreenSettings;t(n,r,n.selection.getBookmark());if(!r.getParam("fullscreen_new_window")){tinymce.dom.Event.remove(e.win,"resize",s.resizeFunc);delete s.resizeFunc;e.remove("mce_fullscreen_container");e.doc.documentElement.style.overflow=i.fullscreen_html_overflow;e.setStyle(e.doc.body,"overflow",i.fullscreen_overflow);e.win.scrollTo(i.fullscreen_scrollx,i.fullscreen_scrolly)}tinyMCE.settings=tinyMCE.oldSettings;delete tinyMCE.oldSettings;delete s.fullscreenEditor;delete s.fullscreenElement;delete s.fullscreenSettings;e.win.setTimeout(function(){r.selection.moveToBookmark(v);r.focus()},10)}},getInfo:function(){return{longname:"Fullscreen",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/fullscreen",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("fullscreen",tinymce.plugins.FullScreenPlugin)})();