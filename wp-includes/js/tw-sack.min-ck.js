function sack(file){this.xmlhttp=null,this.resetData=function(){this.method="POST",this.queryStringSeparator="?",this.argumentSeparator="&",this.URLString="",this.encodeURIString=!0,this.execute=!1,this.element=null,this.elementObj=null,this.requestFile=file,this.vars=new Object,this.responseStatus=new Array(2)},this.resetFunctions=function(){this.onLoading=function(){},this.onLoaded=function(){},this.onInteractive=function(){},this.onCompletion=function(){},this.onError=function(){},this.onFail=function(){}},this.reset=function(){this.resetFunctions(),this.resetData()},this.createAJAX=function(){try{this.xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{this.xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){this.xmlhttp=null}}this.xmlhttp||("undefined"!=typeof XMLHttpRequest?this.xmlhttp=new XMLHttpRequest:this.failed=!0)},this.setVar=function(e,t){this.vars[e]=Array(t,!1)},this.encVar=function(e,t,n){return 1==n?Array(encodeURIComponent(e),encodeURIComponent(t)):(this.vars[encodeURIComponent(e)]=Array(encodeURIComponent(t),!0),void 0)},this.processURLString=function(e,t){for(encoded=encodeURIComponent(this.argumentSeparator),regexp=new RegExp(this.argumentSeparator+"|"+encoded),varArray=e.split(regexp),i=0;i<varArray.length;i++)urlVars=varArray[i].split("="),1==t?this.encVar(urlVars[0],urlVars[1]):this.setVar(urlVars[0],urlVars[1])},this.createURLString=function(e){this.encodeURIString&&this.URLString.length&&this.processURLString(this.URLString,!0),e&&(this.URLString.length?this.URLString+=this.argumentSeparator+e:this.URLString=e),this.setVar("rndval",(new Date).getTime()),urlstringtemp=new Array;for(key in this.vars)0==this.vars[key][1]&&1==this.encodeURIString&&(encoded=this.encVar(key,this.vars[key][0],!0),delete this.vars[key],this.vars[encoded[0]]=Array(encoded[1],!0),key=encoded[0]),urlstringtemp[urlstringtemp.length]=key+"="+this.vars[key][0];this.URLString+=e?this.argumentSeparator+urlstringtemp.join(this.argumentSeparator):urlstringtemp.join(this.argumentSeparator)},this.runResponse=function(){eval(this.response)},this.runAJAX=function(e){if(this.failed)this.onFail();else if(this.createURLString(e),this.element&&(this.elementObj=document.getElementById(this.element)),this.xmlhttp){var t=this;if("GET"==this.method)totalurlstring=this.requestFile+this.queryStringSeparator+this.URLString,this.xmlhttp.open(this.method,totalurlstring,!0);else{this.xmlhttp.open(this.method,this.requestFile,!0);try{this.xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(n){}}this.xmlhttp.onreadystatechange=function(){switch(t.xmlhttp.readyState){case 1:t.onLoading();break;case 2:t.onLoaded();break;case 3:t.onInteractive();break;case 4:t.response=t.xmlhttp.responseText,t.responseXML=t.xmlhttp.responseXML,t.responseStatus[0]=t.xmlhttp.status,t.responseStatus[1]=t.xmlhttp.statusText,t.execute&&t.runResponse(),t.elementObj&&(elemNodeName=t.elementObj.nodeName,elemNodeName.toLowerCase(),"input"==elemNodeName||"select"==elemNodeName||"option"==elemNodeName||"textarea"==elemNodeName?t.elementObj.value=t.response:t.elementObj.innerHTML=t.response),"200"==t.responseStatus[0]?t.onCompletion():t.onError(),t.URLString=""}},this.xmlhttp.send(this.URLString)}},this.reset(),this.createAJAX()};